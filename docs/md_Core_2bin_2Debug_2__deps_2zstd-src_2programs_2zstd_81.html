<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VEX Engine: zstd(1) &ndash; zstd, zstdmt, unzstd, zstdcat - Compress or decompress .zst files</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="RenderedLogoLowRes.png"/></td>
  <td id="projectalign">
   <div id="projectname">VEX Engine
   </div>
   <div id="projectbrief">Retro looking game engine made in vulkan mostly because i wanted to understand it better.</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect" class="search-icon" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"><span class="search-icon-dropdown"></span></span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><div id="MSearchCloseImg" class="close-icon"></div></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('md_Core_2bin_2Debug_2__deps_2zstd-src_2programs_2zstd_81.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">zstd(1) &ndash; zstd, zstdmt, unzstd, zstdcat - Compress or decompress .zst files </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1 class="doxsection"><a class="anchor" id="autotoc_md178"></a>
SYNOPSIS</h1>
<p><span class="tt">zstd</span> [&lt;OPTIONS&gt;] [-|&lt;INPUT-FILE&gt;] [-o &lt;OUTPUT-FILE&gt;]</p>
<p><span class="tt">zstdmt</span> is equivalent to <span class="tt">zstd -T0</span></p>
<p><span class="tt">unzstd</span> is equivalent to <span class="tt">zstd -d</span></p>
<p><span class="tt">zstdcat</span> is equivalent to <span class="tt">zstd -dcf</span></p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md179"></a>
DESCRIPTION</h1>
<p><span class="tt">zstd</span> is a fast lossless compression algorithm and data compression tool, with command line syntax similar to <span class="tt">gzip</span>(1) and <span class="tt">xz</span>(1). It is based on the <b>LZ77</b> family, with further FSE &amp; huff0 entropy stages. <span class="tt">zstd</span> offers highly configurable compression speed, from fast modes at &gt; 200 MB/s per core, to strong modes with excellent compression ratios. It also features a very fast decoder, with speeds &gt; 500 MB/s per core, which remains roughly stable at all compression settings.</p>
<p><span class="tt">zstd</span> command line syntax is generally similar to gzip, but features the following few differences:</p>
<ul>
<li>Source files are preserved by default. It's possible to remove them automatically by using the <span class="tt">--rm</span> command.</li>
<li>When compressing a single file, <span class="tt">zstd</span> displays progress notifications and result summary by default. Use <span class="tt">-q</span> to turn them off.</li>
<li><span class="tt">zstd</span> displays a short help page when command line is an error. Use <span class="tt">-q</span> to turn it off.</li>
<li><span class="tt">zstd</span> does not accept input from console, though it does accept <span class="tt">stdin</span> when it's not the console.</li>
<li><span class="tt">zstd</span> does not store the input's filename or attributes, only its contents.</li>
</ul>
<p><span class="tt">zstd</span> processes each <em>file</em> according to the selected operation mode. If no <em>files</em> are given or <em>file</em> is <span class="tt">-</span>, <span class="tt">zstd</span> reads from standard input and writes the processed data to standard output. <span class="tt">zstd</span> will refuse to write compressed data to standard output if it is a terminal: it will display an error message and skip the file. Similarly, <span class="tt">zstd</span> will refuse to read compressed data from standard input if it is a terminal.</p>
<p>Unless <span class="tt">--stdout</span> or <span class="tt">-o</span> is specified, <em>files</em> are written to a new file whose name is derived from the source <em>file</em> name:</p>
<ul>
<li>When compressing, the suffix <span class="tt">.zst</span> is appended to the source filename to get the target filename.</li>
<li>When decompressing, the <span class="tt">.zst</span> suffix is removed from the source filename to get the target filename</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md180"></a>
Concatenation with .zst Files</h2>
<p>It is possible to concatenate multiple <span class="tt">.zst</span> files. <span class="tt">zstd</span> will decompress such agglomerated file as if it was a single <span class="tt">.zst</span> file.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md181"></a>
OPTIONS</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md182"></a>
Integer Suffixes and Special Values</h2>
<p>In most places where an integer argument is expected, an optional suffix is supported to easily indicate large integers. There must be no space between the integer and the suffix.</p>
<ul>
<li><span class="tt">KiB</span>: Multiply the integer by 1,024 (2\^10). <span class="tt">Ki</span>, <span class="tt">K</span>, and <span class="tt">KB</span> are accepted as synonyms for <span class="tt">KiB</span>.</li>
<li><span class="tt">MiB</span>: Multiply the integer by 1,048,576 (2\^20). <span class="tt">Mi</span>, <span class="tt">M</span>, and <span class="tt">MB</span> are accepted as synonyms for <span class="tt">MiB</span>.</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md183"></a>
Operation Mode</h2>
<p>If multiple operation mode options are given, the last one takes effect.</p>
<ul>
<li><span class="tt">-z</span>, <span class="tt">--compress</span>: Compress. This is the default operation mode when no operation mode option is specified and no other operation mode is implied from the command name (for example, <span class="tt">unzstd</span> implies <span class="tt">--decompress</span>).</li>
<li><span class="tt">-d</span>, <span class="tt">--decompress</span>, <span class="tt">--uncompress</span>: Decompress.</li>
<li><span class="tt">-t</span>, <span class="tt">--test</span>: Test the integrity of compressed <em>files</em>. This option is equivalent to <span class="tt">--decompress --stdout &gt; /dev/null</span>, decompressed data is discarded and checksummed for errors. No files are created or removed.</li>
<li><span class="tt">-b#</span>: Benchmark file(s) using compression level _#_. See <em>BENCHMARK</em> below for a description of this operation.</li>
<li><span class="tt">--train FILES</span>: Use <em>FILES</em> as a training set to create a dictionary. The training set should contain a lot of small files (&gt; 100). See <em>DICTIONARY BUILDER</em> below for a description of this operation.</li>
<li><span class="tt">-l</span>, <span class="tt">--list</span>: Display information related to a zstd compressed file, such as size, ratio, and checksum. Some of these fields may not be available. This command's output can be augmented with the <span class="tt">-v</span> modifier.</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md184"></a>
Operation Modifiers</h2>
<ul>
<li><span class="tt">-#</span>: selects <span class="tt">#</span> compression level [1-19] (default: 3). Higher compression levels <em>generally</em> produce higher compression ratio at the expense of speed and memory. A rough rule of thumb is that compression speed is expected to be divided by 2 every 2 levels. Technically, each level is mapped to a set of advanced parameters (that can also be modified individually, see below). Because the compressor's behavior highly depends on the content to compress, there's no guarantee of a smooth progression from one level to another.</li>
<li><span class="tt">--ultra</span>: unlocks high compression levels 20+ (maximum 22), using a lot more memory. Note that decompression will also require more memory when using these levels.</li>
<li><span class="tt">--fast[=#]</span>: switch to ultra-fast compression levels. If <span class="tt">=#</span> is not present, it defaults to <span class="tt">1</span>. The higher the value, the faster the compression speed, at the cost of some compression ratio. This setting overwrites compression level if one was set previously. Similarly, if a compression level is set after <span class="tt">--fast</span>, it overrides it.</li>
<li><span class="tt">-T#</span>, <span class="tt">--threads=#</span>: Compress using <span class="tt">#</span> working threads (default: 1). If <span class="tt">#</span> is 0, attempt to detect and use the number of physical CPU cores. In all cases, the nb of threads is capped to <span class="tt">ZSTDMT_NBWORKERS_MAX</span>, which is either 64 in 32-bit mode, or 256 for 64-bit environments. This modifier does nothing if <span class="tt">zstd</span> is compiled without multithread support.</li>
<li><p class="startli"><span class="tt">--single-thread</span>: Use a single thread for both I/O and compression. As compression is serialized with I/O, this can be slightly slower. Single-thread mode features significantly lower memory usage, which can be useful for systems with limited amount of memory, such as 32-bit systems.</p>
<p class="startli">Note 1: this mode is the only available one when multithread support is disabled.</p>
<p class="startli">Note 2: this mode is different from <span class="tt">-T1</span>, which spawns 1 compression thread in parallel with I/O. Final compressed result is also slightly different from <span class="tt">-T1</span>.</p>
</li>
<li><span class="tt">--auto-threads={physical,logical} (default: physical)</span>: When using a default amount of threads via <span class="tt">-T0</span>, choose the default based on the number of detected physical or logical cores.</li>
<li><p class="startli"><span class="tt">--adapt[=min=#,max=#]</span>: <span class="tt">zstd</span> will dynamically adapt compression level to perceived I/O conditions. Compression level adaptation can be observed live by using command <span class="tt">-v</span>. Adaptation can be constrained between supplied <span class="tt">min</span> and <span class="tt">max</span> levels. The feature works when combined with multi-threading and <span class="tt">--long</span> mode. It does not work with <span class="tt">--single-thread</span>. It sets window size to 8 MiB by default (can be changed manually, see <span class="tt">wlog</span>). Due to the chaotic nature of dynamic adaptation, compressed result is not reproducible.</p>
<p class="startli"><em>Note</em>: at the time of this writing, <span class="tt">--adapt</span> can remain stuck at low speed when combined with multiple worker threads (&gt;=2).</p>
</li>
<li><p class="startli"><span class="tt">--long[=#]</span>: enables long distance matching with <span class="tt">#</span> <span class="tt">windowLog</span>, if <span class="tt">#</span> is not present it defaults to <span class="tt">27</span>. This increases the window size (<span class="tt">windowLog</span>) and memory usage for both the compressor and decompressor. This setting is designed to improve the compression ratio for files with long matches at a large distance.</p>
<p class="startli">Note: If <span class="tt">windowLog</span> is set to larger than 27, <span class="tt">--long=windowLog</span> or <span class="tt">--memory=windowSize</span> needs to be passed to the decompressor.</p>
</li>
<li><span class="tt">--max</span>: set advanced parameters to maximum compression. warning: this setting is very slow and uses a lot of resources. It's inappropriate for 32-bit mode and therefore disabled in this mode.</li>
<li><span class="tt">-D DICT</span>: use <span class="tt">DICT</span> as Dictionary to compress or decompress FILE(s)</li>
<li><p class="startli"><span class="tt">--patch-from FILE</span>: Specify the file to be used as a reference point for zstd's diff engine. This is effectively dictionary compression with some convenient parameter selection, namely that <em>windowSize</em> &gt; <em>srcSize</em>.</p>
<p class="startli">Note: cannot use both this and <span class="tt">-D</span> together.</p>
<p class="startli">Note: <span class="tt">--long</span> mode will be automatically activated if <em>chainLog</em> &lt; <em>fileLog</em> (<em>fileLog</em> being the <em>windowLog</em> required to cover the whole file). You can also manually force it.</p>
<p class="startli">Note: up to level 15, you can use <span class="tt">--patch-from</span> in <span class="tt">--single-thread</span> mode to improve compression ratio marginally at the cost of speed. Using '&ndash;single-thread' above level 15 will lead to lower compression ratios.</p>
<p class="startli">Note: for level 19, you can get increased compression ratio at the cost of speed by specifying <span class="tt">--zstd=targetLength=</span> to be something large (i.e. 4096), and by setting a large <span class="tt">--zstd=chainLog=</span>.</p>
</li>
<li><span class="tt">--rsyncable</span>: <span class="tt">zstd</span> will periodically synchronize the compression state to make the compressed file more rsync-friendly. There is a negligible impact to compression ratio, and a potential impact to compression speed, perceptible at higher speeds, for example when combining <span class="tt">--rsyncable</span> with many parallel worker threads. This feature does not work with <span class="tt">--single-thread</span>. You probably don't want to use it with long range mode, since it will decrease the effectiveness of the synchronization points, but your mileage may vary.</li>
<li><span class="tt">-C</span>, <span class="tt">--[no-]check</span>: add integrity check computed from uncompressed data (default: enabled)</li>
<li><span class="tt">--[no-]content-size</span>: enable / disable whether or not the original size of the file is placed in the header of the compressed file. The default option is <span class="tt">--content-size</span> (meaning that the original size will be placed in the header).</li>
<li><span class="tt">--no-dictID</span>: do not store dictionary ID within frame header (dictionary compression). The decoder will have to rely on implicit knowledge about which dictionary to use, it won't be able to check if it's correct.</li>
<li><p class="startli"><span class="tt">-M#</span>, <span class="tt">--memory=#</span>: Set a memory usage limit. By default, <span class="tt">zstd</span> uses 128 MiB for decompression as the maximum amount of memory the decompressor is allowed to use, but you can override this manually if need be in either direction (i.e. you can increase or decrease it).</p>
<p class="startli">This is also used during compression when using with <span class="tt">--patch-from=</span>. In this case, this parameter overrides that maximum size allowed for a dictionary. (128 MiB).</p>
<p class="startli">Additionally, this can be used to limit memory for dictionary training. This parameter overrides the default limit of 2 GiB. zstd will load training samples up to the memory limit and ignore the rest.</p>
</li>
<li><span class="tt">--stream-size=#</span>: Sets the pledged source size of input coming from a stream. This value must be exact, as it will be included in the produced frame header. Incorrect stream sizes will cause an error. This information will be used to better optimize compression parameters, resulting in better and potentially faster compression, especially for smaller source sizes.</li>
<li><span class="tt">--size-hint=#</span>: When handling input from a stream, <span class="tt">zstd</span> must guess how large the source size will be when optimizing compression parameters. If the stream size is relatively small, this guess may be a poor one, resulting in a higher compression ratio than expected. This feature allows for controlling the guess when needed. Exact guesses result in better compression ratios. Overestimates result in slightly degraded compression ratios, while underestimates may result in significant degradation.</li>
<li><span class="tt">--target-compressed-block-size=#</span>: Attempt to produce compressed blocks of approximately this size. This will split larger blocks in order to approach this target. This feature is notably useful for improved latency, when the receiver can leverage receiving early incomplete data. This parameter defines a loose target: compressed blocks will target this size "on average", but individual blocks can still be larger or smaller. Enabling this feature can decrease compression speed by up to ~10% at level 1. Higher levels will see smaller relative speed regression, becoming invisible at higher settings.</li>
<li><span class="tt">-f</span>, <span class="tt">--force</span>: disable input and output checks. Allows overwriting existing files, input from console, output to stdout, operating on links, block devices, etc. During decompression and when the output destination is stdout, pass-through unrecognized formats as-is.</li>
<li><span class="tt">-c</span>, <span class="tt">--stdout</span>: write to standard output (even if it is the console); keep original files (disable <span class="tt">--rm</span>).</li>
<li><span class="tt">-o FILE</span>: save result into <span class="tt">FILE</span>. Note that this operation is in conflict with <span class="tt">-c</span>. If both operations are present on the command line, the last expressed one wins.</li>
<li><span class="tt">--[no-]sparse</span>: enable / disable sparse FS support, to make files with many zeroes smaller on disk. Creating sparse files may save disk space and speed up decompression by reducing the amount of disk I/O. default: enabled when output is into a file, and disabled when output is stdout. This setting overrides default and can force sparse mode over stdout.</li>
<li><span class="tt">--[no-]pass-through</span> enable / disable passing through uncompressed files as-is. During decompression when pass-through is enabled, unrecognized formats will be copied as-is from the input to the output. By default, pass-through will occur when the output destination is stdout and the force (<span class="tt">-f</span>) option is set.</li>
<li><span class="tt">--rm</span>: remove source file(s) after successful compression or decompression. This command is silently ignored if output is <span class="tt">stdout</span>. If used in combination with <span class="tt">-o</span>, triggers a confirmation prompt (which can be silenced with <span class="tt">-f</span>), as this is a destructive operation.</li>
<li><span class="tt">-k</span>, <span class="tt">--keep</span>: keep source file(s) after successful compression or decompression. This is the default behavior.</li>
<li><span class="tt">-r</span>: operate recursively on directories. It selects all files in the named directory and all its subdirectories. This can be useful both to reduce command line typing, and to circumvent shell expansion limitations, when there are a lot of files and naming breaks the maximum size of a command line.</li>
<li><span class="tt">--filelist FILE</span> read a list of files to process as content from <span class="tt">FILE</span>. Format is compatible with <span class="tt">ls</span> output, with one file per line.</li>
<li><span class="tt">--output-dir-flat DIR</span>: resulting files are stored into target <span class="tt">DIR</span> directory, instead of same directory as origin file. Be aware that this command can introduce name collision issues, if multiple files, from different directories, end up having the same name. Collision resolution ensures first file with a given name will be present in <span class="tt">DIR</span>, while in combination with <span class="tt">-f</span>, the last file will be present instead.</li>
<li><p class="startli"><span class="tt">--output-dir-mirror DIR</span>: similar to <span class="tt">--output-dir-flat</span>, the output files are stored underneath target <span class="tt">DIR</span> directory, but this option will replicate input directory hierarchy into output <span class="tt">DIR</span>.</p>
<p class="startli">If input directory contains "..", the files in this directory will be ignored. If input directory is an absolute directory (i.e. "/var/tmp/abc"), it will be stored into the "output-dir/var/tmp/abc". If there are multiple input files or directories, name collision resolution will follow the same rules as <span class="tt">--output-dir-flat</span>.</p>
</li>
<li><span class="tt">--format=FORMAT</span>: compress and decompress in other formats. If compiled with support, zstd can compress to or decompress from other compression algorithm formats. Possibly available options are <span class="tt">zstd</span>, <span class="tt">gzip</span>, <span class="tt">xz</span>, <span class="tt">lzma</span>, and <span class="tt">lz4</span>. If no such format is provided, <span class="tt">zstd</span> is the default.</li>
<li><span class="tt">-h</span>/<span class="tt">-H</span>, <span class="tt">--help</span>: display help/long help and exit</li>
<li><span class="tt">-V</span>, <span class="tt">--version</span>: display version number and immediately exit. note that, since it exits, flags specified after <span class="tt">-V</span> are effectively ignored. Advanced: <span class="tt">-vV</span> also displays supported formats. <span class="tt">-vvV</span> also displays POSIX support. <span class="tt">-qV</span> will only display the version number, suitable for machine reading.</li>
<li><span class="tt">-v</span>, <span class="tt">--verbose</span>: verbose mode, display more information</li>
<li><span class="tt">-q</span>, <span class="tt">--quiet</span>: suppress warnings, interactivity, and notifications. specify twice to suppress errors too.</li>
<li><span class="tt">--no-progress</span>: do not display the progress bar, but keep all other messages.</li>
<li><span class="tt">--show-default-cparams</span>: shows the default compression parameters that will be used for a particular input file, based on the provided compression level and the input size. If the provided file is not a regular file (e.g. a pipe), this flag will output the parameters used for inputs of unknown size.</li>
<li><span class="tt">--exclude-compressed</span>: only compress files that are not already compressed.</li>
<li><span class="tt">--</span>: All arguments after <span class="tt">--</span> are treated as files</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md185"></a>
gzip Operation Modifiers</h2>
<p>When invoked via a <span class="tt">gzip</span> symlink, <span class="tt">zstd</span> will support further options that intend to mimic the <span class="tt">gzip</span> behavior:</p>
<ul>
<li><span class="tt">-n</span>, <span class="tt">--no-name</span>: do not store the original filename and timestamps when compressing a file. This is the default behavior and hence a no-op.</li>
<li><span class="tt">--best</span>: alias to the option <span class="tt">-9</span>.</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md186"></a>
Environment Variables</h2>
<p>Employing environment variables to set parameters has security implications. Therefore, this avenue is intentionally limited. Only <span class="tt">ZSTD_CLEVEL</span> and <span class="tt">ZSTD_NBTHREADS</span> are currently supported. They set the default compression level and number of threads to use during compression, respectively.</p>
<p><span class="tt">ZSTD_CLEVEL</span> can be used to set the level between 1 and 19 (the "normal" range). If the value of <span class="tt">ZSTD_CLEVEL</span> is not a valid integer, it will be ignored with a warning message. <span class="tt">ZSTD_CLEVEL</span> just replaces the default compression level (<span class="tt">3</span>).</p>
<p><span class="tt">ZSTD_NBTHREADS</span> can be used to set the number of threads <span class="tt">zstd</span> will attempt to use during compression. If the value of <span class="tt">ZSTD_NBTHREADS</span> is not a valid unsigned integer, it will be ignored with a warning message. <span class="tt">ZSTD_NBTHREADS</span> has a default value of <span class="tt">max(1, min(4, nbCores/4))</span>, and is capped at ZSTDMT_NBWORKERS_MAX==200. <span class="tt">zstd</span> must be compiled with multithread support for this variable to have any effect.</p>
<p>They can both be overridden by corresponding command line arguments: <span class="tt">-#</span> for compression level and <span class="tt">-T#</span> for number of compression threads.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md187"></a>
ADVANCED COMPRESSION OPTIONS</h1>
<p><span class="tt">zstd</span> provides 22 predefined regular compression levels plus the fast levels. A compression level is translated internally into multiple advanced parameters that control the behavior of the compressor (one can observe the result of this translation with <span class="tt">--show-default-cparams</span>). These advanced parameters can be overridden using advanced compression options.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md188"></a>
&ndash;zstd[=options]:</h2>
<p>The <em>options</em> are provided as a comma-separated list. You may specify only the options you want to change and the rest will be taken from the selected or default compression level. The list of available <em>options</em>:</p>
<ul>
<li><p class="startli"><span class="tt">strategy</span>=_strat_, <span class="tt">strat</span>=_strat_: Specify a strategy used by a match finder.</p>
<p class="startli">There are 9 strategies numbered from 1 to 9, from fastest to strongest: 1=<span class="tt">ZSTD_fast</span>, 2=<span class="tt">ZSTD_dfast</span>, 3=<span class="tt">ZSTD_greedy</span>, 4=<span class="tt">ZSTD_lazy</span>, 5=<span class="tt">ZSTD_lazy2</span>, 6=<span class="tt">ZSTD_btlazy2</span>, 7=<span class="tt">ZSTD_btopt</span>, 8=<span class="tt">ZSTD_btultra</span>, 9=<span class="tt">ZSTD_btultra2</span>.</p>
</li>
<li><p class="startli"><span class="tt">windowLog</span>=_wlog_, <span class="tt">wlog</span>=_wlog_: Specify the maximum number of bits for a match distance.</p>
<p class="startli">The higher number of increases the chance to find a match which usually improves compression ratio. It also increases memory requirements for the compressor and decompressor. The minimum <em>wlog</em> is 10 (1 KiB) and the maximum is 30 (1 GiB) on 32-bit platforms and 31 (2 GiB) on 64-bit platforms.</p>
<p class="startli">Note: If <span class="tt">windowLog</span> is set to larger than 27, <span class="tt">--long=windowLog</span> or <span class="tt">--memory=windowSize</span> needs to be passed to the decompressor.</p>
</li>
<li><p class="startli"><span class="tt">hashLog</span>=_hlog_, <span class="tt">hlog</span>=_hlog_: Specify the maximum number of bits for a hash table.</p>
<p class="startli">Bigger hash tables cause fewer collisions which usually makes compression faster, but requires more memory during compression.</p>
<p class="startli">The minimum <em>hlog</em> is 6 (64 entries / 256 B) and the maximum is 30 (1B entries / 4 GiB).</p>
</li>
<li><p class="startli"><span class="tt">chainLog</span>=_clog_, <span class="tt">clog</span>=_clog_: Specify the maximum number of bits for the secondary search structure, whose form depends on the selected <span class="tt">strategy</span>.</p>
<p class="startli">Higher numbers of bits increases the chance to find a match which usually improves compression ratio. It also slows down compression speed and increases memory requirements for compression. This option is ignored for the <span class="tt">ZSTD_fast</span> <span class="tt">strategy</span>, which only has the primary hash table.</p>
<p class="startli">The minimum <em>clog</em> is 6 (64 entries / 256 B) and the maximum is 29 (512M entries / 2 GiB) on 32-bit platforms and 30 (1B entries / 4 GiB) on 64-bit platforms.</p>
</li>
<li><p class="startli"><span class="tt">searchLog</span>=_slog_, <span class="tt">slog</span>=_slog_: Specify the maximum number of searches in a hash chain or a binary tree using logarithmic scale.</p>
<p class="startli">More searches increases the chance to find a match which usually increases compression ratio but decreases compression speed.</p>
<p class="startli">The minimum <em>slog</em> is 1 and the maximum is 'windowLog' - 1.</p>
</li>
<li><p class="startli"><span class="tt">minMatch</span>=_mml_, <span class="tt">mml</span>=_mml_: Specify the minimum searched length of a match in a hash table.</p>
<p class="startli">Larger search lengths usually decrease compression ratio but improve decompression speed.</p>
<p class="startli">The minimum <em>mml</em> is 3 and the maximum is 7.</p>
</li>
<li><p class="startli"><span class="tt">targetLength</span>=_tlen_, <span class="tt">tlen</span>=_tlen_: The impact of this field vary depending on selected strategy.</p>
<p class="startli">For <span class="tt">ZSTD_btopt</span>, <span class="tt">ZSTD_btultra</span> and <span class="tt">ZSTD_btultra2</span>, it specifies the minimum match length that causes match finder to stop searching. A larger <span class="tt">targetLength</span> usually improves compression ratio but decreases compression speed.</p>
<p class="startli">For <span class="tt">ZSTD_fast</span>, it triggers ultra-fast mode when &gt; 0. The value represents the amount of data skipped between match sampling. Impact is reversed: a larger <span class="tt">targetLength</span> increases compression speed but decreases compression ratio.</p>
<p class="startli">For all other strategies, this field has no impact.</p>
<p class="startli">The minimum <em>tlen</em> is 0 and the maximum is 128 KiB.</p>
</li>
<li><p class="startli"><span class="tt">overlapLog</span>=_ovlog_, <span class="tt">ovlog</span>=_ovlog_: Determine <span class="tt">overlapSize</span>, amount of data reloaded from previous job. This parameter is only available when multithreading is enabled. Reloading more data improves compression ratio, but decreases speed.</p>
<p class="startli">The minimum <em>ovlog</em> is 0, and the maximum is 9. 1 means "no overlap", hence completely independent jobs. 9 means "full overlap", meaning up to <span class="tt">windowSize</span> is reloaded from previous job. Reducing <em>ovlog</em> by 1 reduces the reloaded amount by a factor 2. For example, 8 means "windowSize/2", and 6 means "windowSize/8". Value 0 is special and means "default": <em>ovlog</em> is automatically determined by <span class="tt">zstd</span>. In which case, <em>ovlog</em> will range from 6 to 9, depending on selected <em>strat</em>.</p>
</li>
<li><p class="startli"><span class="tt">ldmHashRateLog</span>=_lhrlog_, <span class="tt">lhrlog</span>=_lhrlog_: Specify the frequency of inserting entries into the long distance matching hash table.</p>
<p class="startli">This option is ignored unless long distance matching is enabled.</p>
<p class="startli">Larger values will improve compression speed. Deviating far from the default value will likely result in a decrease in compression ratio.</p>
<p class="startli">The default value varies between 4 and 7, depending on <span class="tt">strategy</span>.</p>
</li>
<li><p class="startli"><span class="tt">ldmHashLog</span>=_lhlog_, <span class="tt">lhlog</span>=_lhlog_: Specify the maximum size for a hash table used for long distance matching.</p>
<p class="startli">This option is ignored unless long distance matching is enabled.</p>
<p class="startli">Bigger hash tables usually improve compression ratio at the expense of more memory during compression and a decrease in compression speed.</p>
<p class="startli">The minimum <em>lhlog</em> is 6 and the maximum is 30 (default: <span class="tt">windowLog - ldmHashRateLog</span>).</p>
</li>
<li><p class="startli"><span class="tt">ldmMinMatch</span>=_lmml_, <span class="tt">lmml</span>=_lmml_: Specify the minimum searched length of a match for long distance matching.</p>
<p class="startli">This option is ignored unless long distance matching is enabled.</p>
<p class="startli">Larger/very small values usually decrease compression ratio.</p>
<p class="startli">The minimum <em>lmml</em> is 4 and the maximum is 4096 (default: 32 to 64, depending on <span class="tt">strategy</span>).</p>
</li>
<li><p class="startli"><span class="tt">ldmBucketSizeLog</span>=_lblog_, <span class="tt">lblog</span>=_lblog_: Specify the size of each bucket for the hash table used for long distance matching.</p>
<p class="startli">This option is ignored unless long distance matching is enabled.</p>
<p class="startli">Larger bucket sizes improve collision resolution but decrease compression speed.</p>
<p class="startli">The minimum <em>lblog</em> is 1 and the maximum is 8 (default: 4 to 8, depending on <span class="tt">strategy</span>).</p>
</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md189"></a>
Example</h2>
<p>The following parameters sets advanced compression options to something similar to predefined level 19 for files bigger than 256 KB:</p>
<p><span class="tt">--zstd</span>=wlog=23,clog=23,hlog=22,slog=6,mml=3,tlen=48,strat=6</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md190"></a>
-B#:</h2>
<p>Specify the size of each compression job. This parameter is only available when multi-threading is enabled. Each compression job is run in parallel, so this value indirectly impacts the nb of active threads. Default job size varies depending on compression level (generally <span class="tt">4 * windowSize</span>). <span class="tt">-B#</span> makes it possible to manually select a custom size. Note that job size must respect a minimum value which is enforced transparently. This minimum is either 512 KB, or <span class="tt">overlapSize</span>, whichever is largest. Different job sizes will lead to non-identical compressed frames.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md191"></a>
DICTIONARY BUILDER</h1>
<p><span class="tt">zstd</span> offers <em>dictionary</em> compression, which greatly improves efficiency on small files and messages. It's possible to train <span class="tt">zstd</span> with a set of samples, the result of which is saved into a file called a <span class="tt">dictionary</span>. Then, during compression and decompression, reference the same dictionary, using command <span class="tt">-D dictionaryFileName</span>. Compression of small files similar to the sample set will be greatly improved.</p>
<ul>
<li><p class="startli"><span class="tt">--train FILEs</span>: Use FILEs as training set to create a dictionary. The training set should ideally contain a lot of samples (&gt; 100), and weight typically 100x the target dictionary size (for example, ~10 MB for a 100 KB dictionary). <span class="tt">--train</span> can be combined with <span class="tt">-r</span> to indicate a directory rather than listing all the files, which can be useful to circumvent shell expansion limits.</p>
<p class="startli">Since dictionary compression is mostly effective for small files, the expectation is that the training set will only contain small files. In the case where some samples happen to be large, only the first 128 KiB of these samples will be used for training.</p>
<p class="startli"><span class="tt">--train</span> supports multithreading if <span class="tt">zstd</span> is compiled with threading support (default). Additional advanced parameters can be specified with <span class="tt">--train-fastcover</span>. The legacy dictionary builder can be accessed with <span class="tt">--train-legacy</span>. The slower cover dictionary builder can be accessed with <span class="tt">--train-cover</span>. Default <span class="tt">--train</span> is equivalent to <span class="tt">--train-fastcover=d=8,steps=4</span>.</p>
</li>
<li><span class="tt">-o FILE</span>: Dictionary saved into <span class="tt">FILE</span> (default name: dictionary).</li>
<li><span class="tt">--maxdict=#</span>: Limit dictionary to specified size (default: 112640 bytes). As usual, quantities are expressed in bytes by default, and it's possible to employ suffixes (like <span class="tt">KB</span> or <span class="tt">MB</span>) to specify larger values.</li>
<li><span class="tt">-#</span>: Use <span class="tt">#</span> compression level during training (optional). Will generate statistics more tuned for selected compression level, resulting in a <em>small</em> compression ratio improvement for this level.</li>
<li><span class="tt">-B#</span>: Split input files into blocks of size # (default: no split)</li>
<li><p class="startli"><span class="tt">-M#</span>, <span class="tt">--memory=#</span>: Limit the amount of sample data loaded for training (default: 2 GB). Note that the default (2 GB) is also the maximum. This parameter can be useful in situations where the training set size is not well controlled and could be potentially very large. Since speed of the training process is directly correlated to the size of the training sample set, a smaller sample set leads to faster training.</p>
<p class="startli">In situations where the training set is larger than maximum memory, the CLI will randomly select samples among the available ones, up to the maximum allowed memory budget. This is meant to improve dictionary relevance by mitigating the potential impact of clustering, such as selecting only files from the beginning of a list sorted by modification date, or sorted by alphabetical order. The randomization process is deterministic, so training of the same list of files with the same parameters will lead to the creation of the same dictionary.</p>
</li>
<li><p class="startli"><span class="tt">--dictID=#</span>: A dictionary ID is a locally unique ID. The decoder will use this value to verify it is using the right dictionary. By default, zstd will create a 4-bytes random number ID. It's possible to provide an explicit number ID instead. It's up to the dictionary manager to not assign twice the same ID to 2 different dictionaries. Note that short numbers have an advantage: an ID &lt; 256 will only need 1 byte in the compressed frame header, and an ID &lt; 65536 will only need 2 bytes. This compares favorably to 4 bytes default.</p>
<p class="startli">Note that RFC8878 reserves IDs less than 32768 and greater than or equal to 2\^31, so they should not be used in public.</p>
</li>
<li><p class="startli"><span class="tt">--train-cover[=k#,d=#,steps=#,split=#,shrink[=#]]</span>: Select parameters for the default dictionary builder algorithm named cover. If <em>d</em> is not specified, then it tries <em>d</em> = 6 and <em>d</em> = 8. If <em>k</em> is not specified, then it tries <em>steps</em> values in the range [50, 2000]. If <em>steps</em> is not specified, then the default value of 40 is used. If <em>split</em> is not specified or split &lt;= 0, then the default value of 100 is used. Requires that <em>d</em> &lt;= <em>k</em>. If <em>shrink</em> flag is not used, then the default value for <em>shrinkDict</em> of 0 is used. If <em>shrink</em> is not specified, then the default value for <em>shrinkDictMaxRegression</em> of 1 is used.</p>
<p class="startli">Selects segments of size <em>k</em> with highest score to put in the dictionary. The score of a segment is computed by the sum of the frequencies of all the subsegments of size <em>d</em>. Generally <em>d</em> should be in the range [6, 8], occasionally up to 16, but the algorithm will run faster with d &lt;= <em>8</em>. Good values for <em>k</em> vary widely based on the input data, but a safe range is [2 * <em>d</em>, 2000]. If <em>split</em> is 100, all input samples are used for both training and testing to find optimal <em>d</em> and <em>k</em> to build dictionary. Supports multithreading if <span class="tt">zstd</span> is compiled with threading support. Having <em>shrink</em> enabled takes a truncated dictionary of minimum size and doubles in size until compression ratio of the truncated dictionary is at most <em>shrinkDictMaxRegression%</em> worse than the compression ratio of the largest dictionary.</p>
<p class="startli">Examples:</p>
<p class="startli"><span class="tt">zstd --train-cover FILEs</span></p>
<p class="startli"><span class="tt">zstd --train-cover=k=50,d=8 FILEs</span></p>
<p class="startli"><span class="tt">zstd --train-cover=d=8,steps=500 FILEs</span></p>
<p class="startli"><span class="tt">zstd --train-cover=k=50 FILEs</span></p>
<p class="startli"><span class="tt">zstd --train-cover=k=50,split=60 FILEs</span></p>
<p class="startli"><span class="tt">zstd --train-cover=shrink FILEs</span></p>
<p class="startli"><span class="tt">zstd --train-cover=shrink=2 FILEs</span></p>
</li>
<li><p class="startli"><span class="tt">--train-fastcover[=k#,d=#,f=#,steps=#,split=#,accel=#]</span>: Same as cover but with extra parameters <em>f</em> and <em>accel</em> and different default value of split If <em>split</em> is not specified, then it tries <em>split</em> = 75. If <em>f</em> is not specified, then it tries <em>f</em> = 20. Requires that 0 &lt; <em>f</em> &lt; 32. If <em>accel</em> is not specified, then it tries <em>accel</em> = 1. Requires that 0 &lt; <em>accel</em> &lt;= 10. Requires that <em>d</em> = 6 or <em>d</em> = 8.</p>
<p class="startli"><em>f</em> is log of size of array that keeps track of frequency of subsegments of size <em>d</em>. The subsegment is hashed to an index in the range [0,2^_f_ - 1]. It is possible that 2 different subsegments are hashed to the same index, and they are considered as the same subsegment when computing frequency. Using a higher <em>f</em> reduces collision but takes longer.</p>
<p class="startli">Examples:</p>
<p class="startli"><span class="tt">zstd --train-fastcover FILEs</span></p>
<p class="startli"><span class="tt">zstd --train-fastcover=d=8,f=15,accel=2 FILEs</span></p>
</li>
<li><p class="startli"><span class="tt">--train-legacy[=selectivity=#]</span>: Use legacy dictionary builder algorithm with the given dictionary <em>selectivity</em> (default: 9). The smaller the <em>selectivity</em> value, the denser the dictionary, improving its efficiency but reducing its achievable maximum size. <span class="tt">--train-legacy=s=#</span> is also accepted.</p>
<p class="startli">Examples:</p>
<p class="startli"><span class="tt">zstd --train-legacy FILEs</span></p>
<p class="startli"><span class="tt">zstd --train-legacy=selectivity=8 FILEs</span></p>
</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="autotoc_md192"></a>
BENCHMARK</h1>
<p>The <span class="tt">zstd</span> CLI provides a benchmarking mode that can be used to easily find suitable compression parameters, or alternatively to benchmark a computer's performance. <span class="tt">zstd -b [FILE(s)]</span> will benchmark <span class="tt">zstd</span> for both compression and decompression using default compression level. Note that results are very dependent on the content being compressed.</p>
<p>It's possible to pass multiple files to the benchmark, and even a directory with <span class="tt">-r DIRECTORY</span>. When no <span class="tt">FILE</span> is provided, the benchmark will use a procedurally generated <span class="tt">lorem ipsum</span> text.</p>
<p>Benchmarking will employ <span class="tt">max(1, min(4, nbCores/4))</span> worker threads by default in order to match the behavior of the normal CLI I/O.</p>
<ul>
<li><span class="tt">-b#</span>: benchmark file(s) using compression level #</li>
<li><span class="tt">-e#</span>: benchmark file(s) using multiple compression levels, from <span class="tt">-b#</span> to <span class="tt">-e#</span> (inclusive)</li>
<li><span class="tt">-d</span>: benchmark decompression speed only (requires providing a zstd-compressed content)</li>
<li><span class="tt">-i#</span>: minimum evaluation time, in seconds (default: 3s), benchmark mode only</li>
<li><span class="tt">-B#</span>, <span class="tt">--block-size=#</span>: cut file(s) into independent chunks of size # (default: no chunking)</li>
<li><span class="tt">-S</span>: output one benchmark result per input file (default: consolidated result)</li>
<li><span class="tt">-D dictionary</span> benchmark using dictionary</li>
<li><span class="tt">--priority=rt</span>: set process priority to real-time (Windows)</li>
</ul>
<p>Beyond compression levels, benchmarking is also compatible with other parameters, such as number of threads (<span class="tt">-T#</span>), advanced compression parameters (<span class="tt">--zstd=###</span>), dictionary compression (<span class="tt">-D dictionary</span>), or even disabling checksum verification for example.</p>
<p><b>Output Format:</b> CompressionLevel#Filename: InputSize -&gt; OutputSize (CompressionRatio), CompressionSpeed, DecompressionSpeed</p>
<p><b>Methodology:</b> For speed measurement, the entire input is compressed/decompressed in-memory to measure speed. A run lasts at least 1 sec, so when files are small, they are compressed/decompressed several times per run, in order to improve measurement accuracy.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md193"></a>
SEE ALSO</h1>
<p><span class="tt">zstdgrep</span>(1), <span class="tt">zstdless</span>(1), <span class="tt">gzip</span>(1), <span class="tt">xz</span>(1)</p>
<p>The &lt;zstandard&gt; format is specified in Y. Collet, "Zstandard Compression and the 'application/zstd' Media Type", <a href="https://www.ietf.org/rfc/rfc8878.txt">https://www.ietf.org/rfc/rfc8878.txt</a>, Internet RFC 8878 (February 2021).</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md194"></a>
BUGS</h1>
<p>Report bugs at: <a href="https://github.com/facebook/zstd/issues">https://github.com/facebook/zstd/issues</a></p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md195"></a>
AUTHOR</h1>
<p>Yann Collet </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
